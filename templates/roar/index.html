{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Roars{% endblock %}</h1>
  {% if g.user %}
    {% include "partials/new_post_button.html" %}
  {% endif %}
{% endblock %}

{% block content %}
  {% include 'partials/post_list.html' %}


  <script>
    $(function() {
      $('a#applaud').bind('click', function() {
        let postID = parseInt($(this).attr('post_id')); // get post id of the clicked pos
        let element = $(this);

        $.getJSON($SCRIPT_ROOT + `/applaud`, { // $SCRIPT_ROOT is set in the base.html file.
          post_id: postID
        }, function(data) {
          if (typeof data == "string") { // this means it returned HTML for the login page.
            window.location.replace("/auth/login");
          } else {
            element.text("dunzo");
          }
        });
        return false;
      });
    });
  </script>
{% endblock %}

